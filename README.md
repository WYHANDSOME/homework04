# CIFAR-10 å›¾åƒåˆ†ç±»å¯¹æŠ—æ”»å‡»ï¼ˆPGDï¼‰

æœ¬é¡¹ç›®åŸºäº PyTorch å®ç°äº†é’ˆå¯¹ CIFAR-10 å›¾åƒåˆ†ç±»ä»»åŠ¡çš„ **ç™½ç›’** å’Œ **é»‘ç›’å¯¹æŠ—æ”»å‡»**ã€‚æ”»å‡»ç®—æ³•ä½¿ç”¨ PGDï¼ˆProjected Gradient Descentï¼‰ã€‚ç›®æ ‡æ¨¡å‹ä¸º **ResNet-20**ï¼Œé»‘ç›’æ”»å‡»ä½¿ç”¨ **VGG11** ä½œä¸ºä»£ç†æ¨¡å‹ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```

â”œâ”€â”€ main.py               # æ‰§è¡Œç™½ç›’ & é»‘ç›’æ”»å‡»
â”œâ”€â”€ resnet\_train.py       # è®­ç»ƒ ResNet-20 æ¨¡å‹
â”œâ”€â”€ vgg11\_train.py        # è®­ç»ƒ VGG11 æ¨¡å‹
â”œâ”€â”€ models/
â”‚   â””â”€â”€ resnet.py         # ResNet-20 æ¨¡å‹ç»“æ„ï¼ˆæ¥è‡ª kuangliu/pytorch-cifarï¼‰
â”œâ”€â”€ data/                 # è‡ªåŠ¨ä¸‹è½½çš„ CIFAR-10 æ•°æ®
â”œâ”€â”€ \*.pth                 # è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡æ–‡ä»¶
â””â”€â”€ \*.png                 # æ”»å‡»ç»“æœå›¾ï¼ˆå‡†ç¡®ç‡æ›²çº¿ä¸å¯¹æŠ—æ ·æœ¬ï¼‰

````

---

## ğŸ› ï¸ ç¯å¢ƒä¾èµ–

å®‰è£…åŸºæœ¬ä¾èµ–ï¼š

```bash
pip install torch torchvision matplotlib
````

ç¡®ä¿ä½ æ‹¥æœ‰ `models/resnet.py` æ–‡ä»¶ï¼Œå¯ä» [kuangliu/pytorch-cifar](https://github.com/kuangliu/pytorch-cifar) è·å–ã€‚

---

## ğŸ”§ æ¨¡å‹è®­ç»ƒ

### âœ… è®­ç»ƒ ResNet-20ï¼ˆç›®æ ‡æ¨¡å‹ï¼‰

```bash
python resnet_train.py
```

æ¨¡å‹ä¼šä¿å­˜åœ¨ï¼š

```
D:\neural_network\ä½œä¸š4\Resnet20\resnet20-12fca82f.th
```

### âœ… è®­ç»ƒ VGG11ï¼ˆä»£ç†æ¨¡å‹ï¼‰

åˆ›å»ºå¹¶è¿è¡Œ `vgg11_train.py`ï¼Œç”¨äºé»‘ç›’æ”»å‡»ï¼š

```bash
python vgg11_train.py
```

ä¿å­˜è·¯å¾„ï¼š

```
D:\neural_network\ä½œä¸š4\VGG11\vgg11_cifar10.pth
```

---

## ğŸ¯ æ‰§è¡Œæ”»å‡»

è¿è¡Œä¸»ç¨‹åºï¼š

```bash
python main.py
```

### ç™½ç›’æ”»å‡»ï¼ˆWhite-boxï¼‰

å¯¹ VGG11 è‡ªèº«è¿›è¡Œ PGD æ”»å‡»ï¼Œæµ‹è¯•ä¸åŒ Îµ ä¸‹æ¨¡å‹å‡†ç¡®ç‡ä¸‹é™æƒ…å†µï¼Œå¹¶ä¿å­˜ï¼š

* å‡†ç¡®ç‡å¯¹æ¯”å›¾ï¼š`whitebox_accuracy_plot.png`
* å¯¹æŠ—æ ·æœ¬å›¾ç¤ºï¼š`adv_examples_eps_8.png` ç­‰

### é»‘ç›’æ”»å‡»ï¼ˆBlack-boxï¼‰

ä½¿ç”¨ VGG11 ç”Ÿæˆå¯¹æŠ—æ ·æœ¬æ”»å‡» ResNet-20ï¼ˆç›®æ ‡æ¨¡å‹ï¼‰

---

## ğŸ“Š å®éªŒç»“æœ

### ç™½ç›’æ”»å‡»ï¼ˆPGD on VGG11ï¼‰

| Îµ å€¼ï¼ˆLâˆ èŒƒæ•°ï¼‰ | æ¨¡å‹å‡†ç¡®ç‡  |
| ---------- | ------ |
| 0.000      | 89.25% |
| 0.008      | 39.24% |
| 0.016      | 8.26%  |
| 0.024      | 2.50%  |
| 0.031      | 1.83%  |

### é»‘ç›’æ”»å‡»ï¼ˆPGD Transfer to ResNet-20ï¼‰

| Îµ å€¼ï¼ˆLâˆ èŒƒæ•°ï¼‰ | å‡†ç¡®ç‡    |
| ---------- | ------ |
| 0.031      | 44.17% |

---

## ğŸ“Œ å‚æ•°è¯´æ˜

å¯åœ¨ `main.py` ä¸­è°ƒæ•´æ”»å‡»å¼ºåº¦å‚æ•°ï¼š

```python
epsilons = [0, 2/255, 4/255, 6/255, 8/255]
alpha = 2/255
iters = 10
```

---

## ğŸ” å‚è€ƒèµ„æ–™

* [Kurakin et al., 2017: Adversarial Examples in the Physical World](https://arxiv.org/abs/1607.02533)
* [kuangliu/pytorch-cifar](https://github.com/kuangliu/pytorch-cifar)

---

## ğŸ“· ç¤ºä¾‹å›¾é¢„è§ˆï¼ˆéƒ¨åˆ†ï¼‰

| å¯¹æŠ—æ‰°åŠ¨ Îµ | ç™½ç›’æ”»å‡»ç¤ºä¾‹å›¾ï¼ˆè‡ªåŠ¨ä¿å­˜ï¼‰                |
| ------ | ---------------------------- |
| 8/255  | `adv_examples_eps_8.png`     |
| å‡†ç¡®ç‡å›¾   | `whitebox_accuracy_plot.png` |

---
